<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from target/filtered-site/markdown/advanced.md at 2026-01-27
 | Rendered using Apache Maven Fluido Skin 2.1.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <title>Advanced Usage – GitHub Copilot Community SDK :: Java</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.1.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.1.0.min.js"></script>
    <style>.github-fork-ribbon:before { background-color: gray; }</style>
  </head>
  <body class="topBarEnabled">
    <a class="github-fork-ribbon right-top" href="https://github.com/copilot-community-sdk/copilot-sdk-java" data-ribbon="Fork me on GitHub">Fork me on GitHub</a>
    <header id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
        <div class="container-fluid">
        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
<a class="brand" href="index.html">GitHub Copilot SDK for Java
</a>
            <ul class="nav">
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">Overview <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="index.html">Introduction</a></li>
            <li><a href="getting-started.html">Getting Started</a></li>
            <li><a href="documentation.html">Documentation</a></li>
            <li><a>Advanced Usage</a></li>
            <li><a href="mcp.html">MCP Servers</a></li>
            <li><a href="apidocs/index.html">Javadoc</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li class="dropdown-submenu">
<a href="documentation.html#API_Reference">API Reference</a>
              <ul class="dropdown-menu">
                  <li><a href="documentation.html#CopilotClient">CopilotClient</a></li>
                  <li><a href="documentation.html#CopilotSession">CopilotSession</a></li>
              </ul>
            </li>
            <li><a href="documentation.html#Event_Types">Event Types</a></li>
            <li><a href="documentation.html#Streaming">Streaming</a></li>
            <li><a href="documentation.html#Listing_Models">Listing Models</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">Advanced <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a href="advanced.html#Manual_Server_Control">Manual Server Control</a></li>
            <li><a href="advanced.html#Tools">Tools</a></li>
            <li><a href="advanced.html#System_Message_Customization">System Message Customization</a></li>
            <li><a href="advanced.html#Multiple_Sessions">Multiple Sessions</a></li>
            <li><a href="advanced.html#File_Attachments">File Attachments</a></li>
            <li><a href="advanced.html#Bring_Your_Own_Key_.28BYOK.29">Bring Your Own Key (BYOK)</a></li>
            <li><a href="advanced.html#Permission_Handling">Permission Handling</a></li>
            <li><a href="advanced.html#Infinite_Sessions">Infinite Sessions</a></li>
            <li><a href="advanced.html#MCP_Servers">MCP Servers</a></li>
            <li><a href="advanced.html#Error_Handling">Error Handling</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li class="dropdown-submenu">
<a href="project-info.html">Project Information</a>
              <ul class="dropdown-menu">
                  <li><a href="dependencies.html">Dependencies</a></li>
                  <li><a href="dependency-info.html">Maven Coordinates</a></li>
                  <li><a href="index.html">About</a></li>
                  <li><a href="licenses.html">Licenses</a></li>
                  <li><a href="plugin-management.html">Plugin Management</a></li>
                  <li><a href="plugins.html">Plugins</a></li>
                  <li><a href="scm.html">Source Code Management</a></li>
                  <li><a href="summary.html">Summary</a></li>
                  <li><a href="team.html">Team</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
<a href="project-reports.html">Project Reports</a>
              <ul class="dropdown-menu">
                  <li><a href="apidocs/index.html">Javadoc</a></li>
              </ul>
            </li>
        </ul>
      </li>
            </ul>
        </div>
      </div>
    </header>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2026-01-27<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0.4-SNAPSHOT<span class="divider">|</span></li>
      <li><a href="index.html">Home</a><span class="divider">/</span></li>
    <li class="active">Advanced Usage</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html">Introduction</a></li>
    <li><a href="getting-started.html">Getting Started</a></li>
    <li><a href="documentation.html">Documentation</a></li>
    <li class="active"><a>Advanced Usage</a></li>
    <li><a href="mcp.html">MCP Servers</a></li>
    <li><a href="apidocs/index.html">Javadoc</a></li>
   <li class="nav-header">Documentation</li>
    <li><a href="documentation.html#API_Reference"><span class="icon-chevron-down"></span>API Reference</a>
     <ul class="nav nav-list">
      <li><a href="documentation.html#CopilotClient">CopilotClient</a></li>
      <li><a href="documentation.html#CopilotSession">CopilotSession</a></li>
     </ul></li>
    <li><a href="documentation.html#Event_Types">Event Types</a></li>
    <li><a href="documentation.html#Streaming">Streaming</a></li>
    <li><a href="documentation.html#Listing_Models">Listing Models</a></li>
   <li class="nav-header">Advanced</li>
    <li><a href="advanced.html#Manual_Server_Control">Manual Server Control</a></li>
    <li><a href="advanced.html#Tools">Tools</a></li>
    <li><a href="advanced.html#System_Message_Customization">System Message Customization</a></li>
    <li><a href="advanced.html#Multiple_Sessions">Multiple Sessions</a></li>
    <li><a href="advanced.html#File_Attachments">File Attachments</a></li>
    <li><a href="advanced.html#Bring_Your_Own_Key_.28BYOK.29">Bring Your Own Key (BYOK)</a></li>
    <li><a href="advanced.html#Permission_Handling">Permission Handling</a></li>
    <li><a href="advanced.html#Infinite_Sessions">Infinite Sessions</a></li>
    <li><a href="advanced.html#MCP_Servers">MCP Servers</a></li>
    <li><a href="advanced.html#Error_Handling">Error Handling</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section><a id="Advanced_Usage"></a>
<h1>Advanced Usage</h1>
<blockquote>

<p>&#x26a0;&#xfe0f; <strong>Disclaimer:</strong> This is an <strong>unofficial, community-driven SDK</strong> and is <strong>not supported or endorsed by GitHub</strong>. Use at your own risk.</p>
</blockquote>
<p>This page covers advanced features and configurations for the Copilot SDK for Java.</p><section><a id="Table_of_Contents"></a>
<h2>Table of Contents</h2>
<ul>

<li><a href="#Manual_Server_Control">Manual Server Control</a></li>
<li><a href="#Tools">Tools</a></li>
<li><a href="#System_Message_Customization">System Message Customization</a></li>
<li><a href="#Multiple_Sessions">Multiple Sessions</a></li>
<li><a href="#File_Attachments">File Attachments</a></li>
<li><a href="#Bring_Your_Own_Key_.28BYOK.29">Bring Your Own Key (BYOK)</a></li>
<li><a href="#Permission_Handling">Permission Handling</a></li>
<li><a href="#Infinite_Sessions">Infinite Sessions</a></li>
<li><a href="#MCP_Servers">MCP Servers</a></li>
<li><a href="#Error_Handling">Error Handling</a></li>
</ul><hr /></section><section><a id="Manual_Server_Control"></a>
<h2>Manual Server Control</h2>

<pre class="prettyprint"><code class="language-java">var client = new CopilotClient(
    new CopilotClientOptions().setAutoStart(false)
);

// Start manually
client.start().get();

// Use client...

// Stop manually
client.stop().get();
</code></pre></section><section><a id="Tools"></a>
<h2>Tools</h2>
<p>You can let the CLI call back into your process when the model needs capabilities you own:</p>

<pre class="prettyprint"><code class="language-java">// Define a record for the tool's arguments (recommended)
record IssueArgs(String id) {}

var lookupTool = ToolDefinition.create(
    &quot;lookup_issue&quot;,
    &quot;Fetch issue details from our tracker&quot;,
    Map.of(
        &quot;type&quot;, &quot;object&quot;,
        &quot;properties&quot;, Map.of(
            &quot;id&quot;, Map.of(&quot;type&quot;, &quot;string&quot;, &quot;description&quot;, &quot;Issue identifier&quot;)
        ),
        &quot;required&quot;, List.of(&quot;id&quot;)
    ),
    invocation -&gt; {
        // Option 1: Type-safe argument access using records (recommended)
        IssueArgs args = invocation.getArgumentsAs(IssueArgs.class);
        return CompletableFuture.completedFuture(fetchIssue(args.id()));
        
        // Option 2: Map-based access (alternative)
        // Map&lt;String, Object&gt; args = invocation.getArguments();
        // String id = (String) args.get(&quot;id&quot;);
        // return CompletableFuture.completedFuture(fetchIssue(id));
    }
);

var session = client.createSession(
    new SessionConfig()
        .setModel(&quot;gpt-5&quot;)
        .setTools(List.of(lookupTool))
).get();
</code></pre></section><section><a id="System_Message_Customization"></a>
<h2>System Message Customization</h2>
<p>Control the system prompt using <code>SystemMessageConfig</code> in session config:</p>

<pre class="prettyprint"><code class="language-java">var session = client.createSession(
    new SessionConfig()
        .setModel(&quot;gpt-5&quot;)
        .setSystemMessage(new SystemMessageConfig()
            .setMode(SystemMessageMode.APPEND)
            .setContent(&quot;&quot;&quot;
                &lt;workflow_rules&gt;
                - Always check for security vulnerabilities
                - Suggest performance improvements when applicable
                &lt;/workflow_rules&gt;
            &quot;&quot;&quot;))
).get();
</code></pre>
<p>For full control (removes all guardrails), use <code>REPLACE</code> mode:</p>

<pre class="prettyprint"><code class="language-java">var session = client.createSession(
    new SessionConfig()
        .setModel(&quot;gpt-5&quot;)
        .setSystemMessage(new SystemMessageConfig()
            .setMode(SystemMessageMode.REPLACE)
            .setContent(&quot;You are a helpful assistant.&quot;))
).get();
</code></pre></section><section><a id="Multiple_Sessions"></a>
<h2>Multiple Sessions</h2>

<pre class="prettyprint"><code class="language-java">var session1 = client.createSession(
    new SessionConfig().setModel(&quot;gpt-5&quot;)
).get();

var session2 = client.createSession(
    new SessionConfig().setModel(&quot;claude-sonnet-4.5&quot;)
).get();

// Both sessions are independent
session1.send(new MessageOptions().setPrompt(&quot;Hello from session 1&quot;)).get();
session2.send(new MessageOptions().setPrompt(&quot;Hello from session 2&quot;)).get();
</code></pre></section><section><a id="File_Attachments"></a>
<h2>File Attachments</h2>

<pre class="prettyprint"><code class="language-java">session.send(new MessageOptions()
    .setPrompt(&quot;Analyze this file&quot;)
    .setAttachments(List.of(
        new Attachment()
            .setType(&quot;file&quot;)
            .setPath(&quot;/path/to/file.java&quot;)
            .setDisplayName(&quot;My File&quot;)
    ))
).get();
</code></pre></section><section><a id="Bring_Your_Own_Key_.28BYOK.29"></a>
<h2>Bring Your Own Key (BYOK)</h2>
<p>Use a custom API provider:</p>

<pre class="prettyprint"><code class="language-java">var session = client.createSession(
    new SessionConfig()
        .setProvider(new ProviderConfig()
            .setType(&quot;openai&quot;)
            .setBaseUrl(&quot;https://api.openai.com/v1&quot;)
            .setApiKey(&quot;your-api-key&quot;))
).get();
</code></pre></section><section><a id="Permission_Handling"></a>
<h2>Permission Handling</h2>
<p>Handle permission requests from the CLI:</p>

<pre class="prettyprint"><code class="language-java">var session = client.createSession(
    new SessionConfig()
        .setModel(&quot;gpt-5&quot;)
        .setOnPermissionRequest((request, invocation) -&gt; {
            // Approve or deny the permission request
            var result = new PermissionRequestResult();
            result.setKind(&quot;user-approved&quot;);
            return CompletableFuture.completedFuture(result);
        })
).get();
</code></pre></section><section><a id="Infinite_Sessions"></a>
<h2>Infinite Sessions</h2>
<p>Infinite sessions enable automatic context management for long-running conversations. When enabled (default), the session automatically manages context window limits through background compaction and persists state to a workspace directory.</p><section><a id="How_It_Works"></a>
<h3>How It Works</h3>
<p>As conversations grow, they eventually approach the model's context window limit. Infinite sessions solve this by:</p>
<ol style="list-style-type: decimal;">

<li>
<p><strong>Background Compaction</strong>: When context utilization reaches the background threshold (default 80%), the session starts compacting older messages asynchronously while continuing to process new messages.</p></li>
<li>
<p><strong>Buffer Exhaustion Protection</strong>: If context reaches the exhaustion threshold (default 95%) before compaction completes, the session blocks until compaction finishes to prevent overflow.</p></li>
<li>
<p><strong>Workspace Persistence</strong>: Session state is persisted to a workspace directory containing:</p>
<ul>

<li><code>checkpoints/</code> - Session checkpoints for resumption</li>
<li><code>plan.md</code> - Current conversation plan</li>
<li><code>files/</code> - Associated files</li>
</ul></li>
</ol></section><section><a id="Configuration"></a>
<h3>Configuration</h3>

<pre class="prettyprint"><code class="language-java">var infiniteConfig = new InfiniteSessionConfig()
    .setEnabled(true)
    .setBackgroundCompactionThreshold(0.80)  // Start compacting at 80% utilization
    .setBufferExhaustionThreshold(0.95);     // Block at 95% until compaction completes

var session = client.createSession(
    new SessionConfig()
        .setModel(&quot;gpt-5&quot;)
        .setInfiniteSessions(infiniteConfig)
).get();
</code></pre></section><section><a id="Configuration_Options"></a>
<h3>Configuration Options</h3>
<table class="table table-striped">
<thead>
<tr class="a">
<th>Option</th>
<th>Default</th>
<th>Description</th></tr></thead><tbody>
<tr class="b">
<td><code>enabled</code></td>
<td><code>true</code></td>
<td>Whether infinite sessions are enabled</td></tr>
<tr class="a">
<td><code>backgroundCompactionThreshold</code></td>
<td><code>0.80</code></td>
<td>Context utilization (0.0-1.0) at which background compaction starts</td></tr>
<tr class="b">
<td><code>bufferExhaustionThreshold</code></td>
<td><code>0.95</code></td>
<td>Context utilization (0.0-1.0) at which the session blocks until compaction completes</td></tr></tbody>
</table>
</section><section><a id="Accessing_the_Workspace"></a>
<h3>Accessing the Workspace</h3>
<p>When infinite sessions are enabled, you can access the workspace path:</p>

<pre class="prettyprint"><code class="language-java">var session = client.createSession(
    new SessionConfig()
        .setModel(&quot;gpt-5&quot;)
        .setInfiniteSessions(new InfiniteSessionConfig().setEnabled(true))
).get();

String workspacePath = session.getWorkspacePath();
if (workspacePath != null) {
    System.out.println(&quot;Session workspace: &quot; + workspacePath);
    // Access checkpoints/, plan.md, files/ subdirectories
}
</code></pre></section><section><a id="Disabling_Infinite_Sessions"></a>
<h3>Disabling Infinite Sessions</h3>
<p>For short conversations where context management isn't needed:</p>

<pre class="prettyprint"><code class="language-java">var session = client.createSession(
    new SessionConfig()
        .setModel(&quot;gpt-5&quot;)
        .setInfiniteSessions(new InfiniteSessionConfig().setEnabled(false))
).get();

// session.getWorkspacePath() will return null
</code></pre></section></section><section><a id="MCP_Servers"></a>
<h2>MCP Servers</h2>
<p>The Copilot SDK can integrate with MCP servers (Model Context Protocol) to extend the assistant's capabilities with external tools. MCP servers run as separate processes and expose tools that Copilot can invoke during conversations.</p>
<p>&#x1f4d6; <strong><a href="mcp.html">Full MCP documentation &#x2192;</a></strong> - Learn about local vs remote servers, all configuration options, and troubleshooting.</p>
<p>Quick example:</p>

<pre class="prettyprint"><code class="language-java">Map&lt;String, Object&gt; filesystemServer = new HashMap&lt;&gt;();
filesystemServer.put(&quot;type&quot;, &quot;local&quot;);
filesystemServer.put(&quot;command&quot;, &quot;npx&quot;);
filesystemServer.put(&quot;args&quot;, List.of(&quot;-y&quot;, &quot;@modelcontextprotocol/server-filesystem&quot;, &quot;/tmp&quot;));
filesystemServer.put(&quot;tools&quot;, List.of(&quot;*&quot;));

var session = client.createSession(
    new SessionConfig()
        .setMcpServers(Map.of(&quot;filesystem&quot;, filesystemServer))
).get();
</code></pre></section><section><a id="Error_Handling"></a>
<h2>Error Handling</h2>

<pre class="prettyprint"><code class="language-java">try {
    var session = client.createSession().get();
    session.send(new MessageOptions().setPrompt(&quot;Hello&quot;)).get();
} catch (ExecutionException ex) {
    Throwable cause = ex.getCause();
    System.err.println(&quot;Error: &quot; + cause.getMessage());
}
</code></pre></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2026
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
